#
# This configuration file reads tab-separated input generated by the Java-program gclog.Main and
# delivers the result to elasticsearch.
#

input {
	stdin { }
}

filter {
	# Parse each tab-separated line
	grok {
		match => [ "message", "(?<date>.*?)\t(?<node>.*?)\t(?<type>.*?)\t%{NUMBER:duration:int}\t%{NUMBER:memtotal:int}\t%{NUMBER:memused:int}\t%{NUMBER:memfree:int}" ]
	}	

	# Parse the dates and use them as logstas timestamp.
	date {
        	match => [ "date", "yyyy-MM-dd'T'HH:mm:ss.SSS" ]
   	}
   	
   	# Remove the field containing the date in string-format.
	mutate {
            remove_field => ["message", "date"]
    }
}

# Output to logstash and to stdout.
output {
	elasticsearch {}
  	stdout {
    		codec => rubydebug
  	}
}


